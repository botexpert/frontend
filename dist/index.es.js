import e from"react";import{Dialog as t,DialogTitle as r,TextField as n,Button as a,Badge as s,Card as o,CardContent as i,Typography as c,CardActions as u,Snackbar as l,Paper as p,MenuItem as h,ListItemIcon as d,AppBar as f,Toolbar as m,IconButton as v,Drawer as y,ListItem as g,Avatar as w,ListItemText as E,ListItemSecondaryAction as b,Switch as x,List as k,Fab as C}from"@material-ui/core";import{Link as S,withRouter as P}from"react-router-dom";import O from"axios";import D from"@material-ui/icons/Clear";import L from"@material-ui/icons/Dashboard";import j from"@material-ui/icons/AccountCircle";import A from"@material-ui/icons/Reorder";import R from"@material-ui/icons/PeopleOutline";import _ from"@material-ui/icons/People";import N from"@material-ui/icons/Add";var M=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",i=a.toStringTag||"@@toStringTag";function c(e,t,r,n){var a=t&&t.prototype instanceof m?t:m,s=Object.create(a.prototype),o=new O(n||[]);return s._invoke=function(e,t,r){var n=l;return function(a,s){if(n===h)throw new Error("Generator is already running");if(n===d){if("throw"===a)throw s;return L()}for(r.method=a,r.arg=s;;){var o=r.delegate;if(o){var i=C(o,r);if(i){if(i===f)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=h;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?d:p,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=d,r.method="throw",r.arg=c.arg)}}}(e,r,o),s}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",p="suspendedYield",h="executing",d="completed",f={};function m(){}function v(){}function y(){}var g={};g[s]=function(){return this};var w=Object.getPrototypeOf,E=w&&w(w(D([])));E&&E!==r&&n.call(E,s)&&(g=E);var b=y.prototype=m.prototype=Object.create(g);function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function k(e){var t;this._invoke=function(r,a){function s(){return new Promise((function(t,s){!function t(r,a,s,o){var i=u(e[r],e,a);if("throw"!==i.type){var c=i.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(e){t("next",e,s,o)}),(function(e){t("throw",e,s,o)})):Promise.resolve(l).then((function(e){c.value=e,s(c)}),(function(e){return t("throw",e,s,o)}))}o(i.arg)}(r,a,t,s)}))}return t=t?t.then(s,s):s()}}function C(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,C(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,f;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:L}}function L(){return{value:t,done:!0}}return v.prototype=b.constructor=y,y.constructor=v,y[i]=v.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(k.prototype),k.prototype[o]=function(){return this},e.AsyncIterator=k,e.async=function(t,r,n,a){var s=new k(c(t,r,n,a));return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(b),b[i]="Generator",b[s]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=D,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return i.type="throw",i.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e,t,r){return t&&F(e.prototype,t),r&&F(e,r),e}function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e){return(H="function"==typeof Symbol&&"symbol"===q(Symbol.iterator)?function(e){return q(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":q(e)})(e)}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return!t||"object"!==H(t)&&"function"!=typeof t?U(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}function Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function X(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?K(Object(r),!0).forEach((function(t){Y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var J={display:"flex",justifyContent:"center",alignItems:"center"},Q={root:X({},J,{height:"100vh"}),paper:X({},J,{width:400,height:400,textAlign:"center"}),button:X({},J,{marginBottom:10}),form:X({},J,{flexDirection:"column"})},V=e.createContext({}),Z=function(t){return function(r){return e.createElement(V.Consumer,null,(function(n){return e.createElement(t,Object.assign({},r,{store:n}))}))}},$=function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"protect",(function(){var e,r,n;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=t.props.store,r=e.auth,n=e.me,a.next=3,M.awrap(r.refresh());case 3:a.sent.ok?n.detail.id||n.fetch():t.props.secure&&t.props.store.history.push("/");case 5:case"end":return a.stop()}}))})),t.protect(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){return null}}]),r}();$.defaultProps={secure:!1};var ee=Z($),te={display:"flex",justifyContent:"center",alignItems:"center"},re={root:X({},te,{height:"100vh",width:"100vw"}),content:{minHeight:300,minWidth:300},form:X({},te,{flexDirection:"column"})},ne=function(s){function o(e){var t;return T(this,o),Y(U(t=G(this,B(o).call(this,e))),"handleName",(function(e){t.setState({name:e.target.value})})),Y(U(t),"handleSubmit",(function(e){var r,n,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e.preventDefault(),r=t.state.name,n=t.props.store,a=n.role,s=n.notification,o.next=5,M.awrap(a.create({name:r}));case 5:o.sent.ok?s.show("Role created"):s.show("Error"),t.props.close();case 8:case"end":return o.stop()}}))})),t.state={name:""},t}return z(o,e.Component),I(o,[{key:"render",value:function(){return e.createElement(t,{onClose:this.props.close,open:this.props.open},e.createElement(r,null,"Create new role"),e.createElement("form",{onSubmit:this.handleSubmit,style:re.form},e.createElement(n,{autoFocus:!0,required:!0,fullWidth:!0,label:"Name",variant:"outlined",value:this.state.name,onChange:this.handleName}),e.createElement(a,{fullWidth:!0,type:"submit",color:"primary",variant:"contained"},"Create"),e.createElement(a,{fullWidth:!0,color:"secondary",variant:"outlined",onClick:this.props.close},"Cancel")))}}]),o}();ne.defaultProps={open:!1};var ae=Z(ne),se={card:{minWidth:120,marginRight:10,marginLeft:10}},oe=Z(function(t){function r(e){var t;return T(this,r),t=G(this,B(r).call(this,e)),e.store.role.fetchAll(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(s,{color:"primary",badgeContent:this.props.store.role.list.total},e.createElement(o,{style:se.card},e.createElement(i,null,e.createElement(c,{variant:"h5","data-id":"roles"},"Roles"),e.createElement(c,{color:"textSecondary"},"All roles")),e.createElement(u,null,e.createElement(S,{to:"/roles"},e.createElement(a,{variant:"outlined",size:"small"},"Explore")))))}}]),r}()),ie={card:{minWidth:120,marginRight:10,marginLeft:10}},ce=Z(function(t){function r(e){var t;return T(this,r),t=G(this,B(r).call(this,e)),e.store.user.fetchAll(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(s,{color:"primary",badgeContent:this.props.store.user.list.total},e.createElement(o,{style:ie.card},e.createElement(i,null,e.createElement(c,{variant:"h5","data-id":"users"},"Users"),e.createElement(c,{color:"textSecondary"},"All users")),e.createElement(u,null,e.createElement(S,{to:"/users"},e.createElement(a,{variant:"outlined",size:"small"},"Explore")))))}}]),r}()),ue=function(t){var r=t.store.notification;return e.createElement("div",{style:t.style},e.createElement(ee,{secure:t.secure}),t.children,e.createElement(l,{autoHideDuration:5e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},open:r.detail.show,onClose:r.close,message:r.detail.message,action:e.createElement(a,{color:"secondary",size:"small",onClick:r.close},"CLOSE")}))};ue.defaultProps={children:null,secure:!1,style:{padding:20}};var le=Z(ue),pe=O.create({baseURL:"/api/v0",withCredentials:!0});pe.interceptors.request.use((function(e){var t=function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()}("/auth/refresh"===e.url?"csrf_refresh_token":"csrf_access_token");return e.headers.withCredentials=!0,t&&(e.headers["X-CSRF-TOKEN"]=t),e}),(function(e){return Promise.reject(e)}));var he=function(e){var t=e.response&&e.response.data?e.response.data:{};return t.message||(t.msg?t.message=t.msg:t.statusText?t.message=t.statusText:t.status&&(t.message=t.status)),t.errors&&Object.getOwnPropertyNames(t.errors).forEach((function(e){"message"!==e&&(t.errors[e]=t.errors[e].join(" "))})),t},de=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"handleSubmit",(function(e){var r,n,a,s,o,i;return M.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e.preventDefault(),r=t.state.password,n=t.props.store,a=n.auth,s=n.notification,c.next=5,M.awrap(a.changePassword(r,t.props.match.params.token));case 5:(o=c.sent).ok?s.show("You can login with your new password"):(i=he(o),s.show(i.message));case 7:case"end":return c.stop()}}))})),Y(U(t),"handlePassword",(function(e){t.setState({password:e.target.value})})),t.state={password:""},t}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(le,{style:{}},e.createElement("div",{style:Q.root},e.createElement(p,{style:Q.paper},e.createElement("div",null,e.createElement("h1",null,"Reset Password"),e.createElement("form",{style:Q.form,onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement(n,{required:!0,autoFocus:!0,label:"Password","data-id":"password",value:this.state.password,onChange:this.handlePassword,type:"password"})),e.createElement("div",{style:Q.button},e.createElement(a,{variant:"contained",type:"submit"},"Reset Password")))))))}}]),r}()),fe={detail:{refreshing:!1}},me=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"handleSubmit",(function(e){var r,n,a,s,o,i,c,u,l;return M.async((function(p){for(;;)switch(p.prev=p.next){case 0:return e.preventDefault(),r=t.props.store,n=r.auth,a=r.history,s=r.notification,o=t.state,i=o.email,c=o.password,p.next=5,M.awrap(n.login(i,c));case 5:(u=p.sent).ok?(a.push("/dashboard"),n.refresh()):(l=he(u),s.show(l.message));case 7:case"end":return p.stop()}}))})),Y(U(t),"handleEmail",(function(e){t.setState({email:e.target.value})})),Y(U(t),"handlePassword",(function(e){t.setState({password:e.target.value})})),t.state={email:"",password:""},t}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(le,{style:{}},e.createElement("div",{style:Q.root},e.createElement(p,{style:Q.paper},e.createElement("div",null,e.createElement("h1",null,"Login"),e.createElement("form",{style:Q.form,onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement(n,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",value:this.state.email,onChange:this.handleEmail,type:"email"})),e.createElement("div",null,e.createElement(n,{required:!0,label:"Password",type:"password",margin:"normal","data-id":"password",value:this.state.password,onChange:this.handlePassword})),e.createElement("div",{style:Q.button},e.createElement(a,{variant:"contained",type:"submit"},"Login")),e.createElement(S,{to:"/reset"},"forgot password?"))))))}}]),r}()),ve=Z(function(t){function r(t){var n;return T(this,r),Y(U(n=G(this,B(r).call(this,t))),"handleSubmit",(function(t){var r,a,s,o,i,c,u;return M.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(t.preventDefault(),r=n.props.store,a=r.auth,s=r.notification,o=n.state,i=o.password,c=o.repeatPassword,i===c){l.next=6;break}return s.show("Passwords must match!"),l.abrupt("return");case 6:return l.next=8,M.awrap(a.register(n.state.email,n.state.password));case 8:(u=l.sent).ok?s.show(e.createElement("div",null,"You are now registered! Once admin approves your account you should be able to  ",e.createElement(S,{to:"/login"},"login"))):s.show(u.error),n.setState({password:"",repeatPassword:""});case 11:case"end":return l.stop()}}))})),Y(U(n),"handleEmail",(function(e){n.setState({email:e.target.value})})),Y(U(n),"handlePassword",(function(e){n.setState({password:e.target.value})})),Y(U(n),"handleRepeatPassword",(function(e){n.setState({repeatPassword:e.target.value})})),n.state={email:"",password:"",repeatPassword:""},n}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(le,{style:{}},e.createElement("div",{style:Q.root},e.createElement(p,{style:Q.paper},e.createElement("div",null,e.createElement("h1",null,"Register"),e.createElement("form",{style:Q.form,onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement(n,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",onChange:this.handleEmail,value:this.state.email,type:"email"})),e.createElement("div",null,e.createElement(n,{required:!0,label:"Password",type:"password",margin:"normal","data-id":"password",onChange:this.handlePassword,value:this.state.password})),e.createElement("div",null,e.createElement(n,{required:!0,label:"Repeat Password",type:"password",margin:"normal","data-id":"repeatPassword",onChange:this.handleRepeatPassword,value:this.state.repeatPassword})),e.createElement("div",{style:Q.button},e.createElement(a,{variant:"contained",type:"submit"},"Register")))))))}}]),r}()),ye=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"handleSubmit",(function(e){var r,n,a,s,o,i;return M.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e.preventDefault(),r=t.state.email,n=t.props.store,a=n.auth,s=n.notification,c.next=5,M.awrap(a.reset(r));case 5:(o=c.sent).ok?s.show("Email with instructions sent to ".concat(r)):(i=he(o),s.show(i.message));case 7:case"end":return c.stop()}}))})),Y(U(t),"handleEmail",(function(e){t.setState({email:e.target.value})})),t.state={email:""},t}return z(r,e.Component),I(r,[{key:"render",value:function(){return e.createElement(le,{style:{}},e.createElement("div",{style:Q.root},e.createElement(p,{style:Q.paper},e.createElement("div",null,e.createElement("h1",null,"Reset Password"),e.createElement("form",{style:Q.form,onSubmit:this.handleSubmit},e.createElement("div",null,e.createElement(n,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",value:this.state.email,onChange:this.handleEmail,type:"email"})),e.createElement("div",{style:Q.button},e.createElement(a,{variant:"contained",type:"submit"},"Reset Password")))))))}}]),r}()),ge=function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.post("/auth/login",{email:e,password:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},we=function(){var e;return M.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.awrap(pe.post("/auth/logout",{}));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},Ee=function(){var e;return M.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.awrap(pe.post("/auth/refresh",{}));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},be=function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.post("/auth/register",{email:e,password:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},xe=function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.post("/auth/reset/request",{email:e}));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},ke=function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.post("/auth/reset",{password:e,token:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},Ce={changePassword:de,initial:fe,login:me,register:ve,reset:ye,store:function e(t){var r=this;T(this,e),Y(this,"timeoutHandler",null),Y(this,"login",(function(e,t){var n,a,s,o,i;return M.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,M.awrap(ge(e,t));case 3:return n=c.sent,a=n.accessExpire,s=n.refreshExpire,o={accessExpire:a,refreshExpire:s,ok:!0},r.setDetail(o),c.abrupt("return",o);case 10:return c.prev=10,c.t0=c.catch(0),i=X({},fe,{ok:!1}),r.setDetail(i),c.abrupt("return",X({},c.t0,{},i));case 15:case"end":return c.stop()}}),null,null,[[0,10]])})),Y(this,"logout",(function(){var e,t;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,M.awrap(we());case 3:return e={},r.setDetail(e),n.abrupt("return",e);case 8:return n.prev=8,n.t0=n.catch(0),t={ok:!1},r.setDetail(t),n.abrupt("return",X({},n.t0,{},t));case 13:case"end":return n.stop()}}),null,null,[[0,8]])})),Y(this,"refresh",(function(){var e,t,n,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:if(!r.detail.refreshing){o.next=2;break}return o.abrupt("return",X({},r.detail,{ok:!0}));case 2:return o.prev=2,o.next=5,M.awrap(Ee());case 5:return e=o.sent,t=e.accessExpire,n=e.refreshExpire,a=X({},r.detail,{accessExpire:t,refreshExpire:n,refreshing:!0,ok:!0}),r.setDetail(a),clearTimeout(r.timeoutHandler),r.timeoutHandler=setTimeout((function(){r.setDetail(X({},r.detail,{refreshing:!1})),r.refresh()}),1e3*a.accessExpire),o.abrupt("return",a);case 14:return o.prev=14,o.t0=o.catch(2),clearTimeout(r.timeoutHandler),r.timeoutHandler=null,s=X({},fe,{ok:!1}),r.setDetail(s),o.abrupt("return",X({},o.t0,{},s));case 21:case"end":return o.stop()}}),null,null,[[2,14]])})),Y(this,"register",(function(e,t){var n,a,s,o,i;return M.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,M.awrap(be(e,t));case 3:return n=c.sent,a=n.accessExpire,s=n.refreshExpire,o={accessExpire:a,refreshExpire:s,ok:!0},r.setDetail(o),c.abrupt("return",o);case 10:return c.prev=10,c.t0=c.catch(0),i=X({},fe,{ok:!1}),r.setDetail(i),c.abrupt("return",X({},c.t0,{},i));case 15:case"end":return c.stop()}}),null,null,[[0,10]])})),Y(this,"reset",(function(e){var t,r,n;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M.awrap(xe(e));case 3:return t=a.sent,r=X({},t,{ok:!0}),a.abrupt("return",r);case 8:return a.prev=8,a.t0=a.catch(0),n=X({},a.t0,{ok:!1}),a.abrupt("return",n);case 12:case"end":return a.stop()}}),null,null,[[0,8]])})),Y(this,"changePassword",(function(e,t){var r,n,a;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,M.awrap(ke(e,t));case 3:return r=s.sent,n=X({},r,{ok:!0}),s.abrupt("return",n);case 8:return s.prev=8,s.t0=s.catch(0),a=X({},s.t0,{ok:!1}),s.abrupt("return",a);case 12:case"end":return s.stop()}}),null,null,[[0,8]])})),this.detail=t[0],this.setDetail=t[1]}},Se={flex:{flex:1},menu:{width:200},login:{color:"white"}},Pe=function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"handleLogout",(function(){var e;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e=t.props.store.auth,r.next=3,M.awrap(e.logout());case 3:void 0===r.sent.ok&&t.props.history.push("/");case 5:case"end":return r.stop()}}))})),Y(U(t),"handleMenuOpen",(function(){t.setState({showMenu:!0})})),Y(U(t),"handleMenuClose",(function(){t.setState({showMenu:!1})})),t.state={showMenu:!1},t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t=this.props.store.auth,r=e.createElement(S,{to:"/login",style:Se.login},e.createElement(a,{color:"inherit"},"Login")),n=e.createElement(a,{color:"inherit",onClick:this.handleLogout},"Logout"),s=t.detail.ok?n:r,o=t.detail.ok?[e.createElement(S,{to:"/dashboard",key:"dashboard"},e.createElement(h,null,e.createElement(d,null,e.createElement(L,null)),"Dashboard")),e.createElement(S,{to:"/me",key:"me"},e.createElement(h,null,e.createElement(d,null,e.createElement(j,null)),"Me")),e.createElement(S,{to:"/users",key:"users"},e.createElement(h,null,e.createElement(d,null,e.createElement(R,null)),"Users")),e.createElement(S,{to:"/roles",key:"roles"},e.createElement(h,null,e.createElement(d,null,e.createElement(_,null)),"Roles"))]:null;return e.createElement("div",null,e.createElement(f,{position:"static"},e.createElement(m,null,e.createElement(c,{variant:"h5",color:"inherit",style:Se.flex},e.createElement(v,{color:"inherit",onClick:this.handleMenuOpen},e.createElement(A,null)),e.createElement(S,{to:"/","data-id":"app"},"Freenit")),s)),e.createElement(le,{secure:this.props.secure,style:this.props.style},this.props.children,e.createElement(y,{open:this.state.showMenu,onClose:this.handleMenuClose},e.createElement(f,{position:"static"},e.createElement(m,null,e.createElement(c,{variant:"h5",color:"inherit",style:Se.flex}," "),e.createElement(v,{color:"inherit",onClick:this.handleMenuClose},e.createElement(D,null)))),e.createElement("div",{role:"button",onClick:this.handleMenuClose,style:Se.menu,tabIndex:0,onKeyDown:this.handleMenuClose},o))))}}]),r}();Pe.defaultProps={children:null,secure:!1,style:{}};var Oe=P(Z(Pe)),De={root:{display:"flex",justifyContent:"space-between",alignItems:"center"},template:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 64px - 40px)",padding:20}},Le={detail:function(){return e.createElement(Oe,{secure:!0,style:De.template},e.createElement("div",{style:De.root},e.createElement(oe,null),e.createElement(ce,null)))}},je={root:{display:"block",minHeight:"calc(100vh - 65px - 40px)",padding:20},item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},page:{marginLeft:10,marginRight:10},center:X({},{display:"flex",justifyContent:"center",alignItems:"center"}),avatar:{marginRight:10},h1:{marginBottom:30,color:"#3f51b5",small:{margin:0},textAlign:"center"},form:{display:"flex"},button:{marginLeft:10,width:80}},Ae=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"fetch",(function(){var e,r,n;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=t.props.store,a.next=3,M.awrap(e.me.fetch());case 3:(r=a.sent).ok?t.setState({email:r.email}):(n=he(r),e.notification.show(n.message));case 5:case"end":return a.stop()}}))})),Y(U(t),"handleEmail",(function(e){t.setState({email:e.target.value})})),Y(U(t),"handleEmailCancel",(function(){t.setState({email:t.props.store.me.detail.email})})),Y(U(t),"handleSubmit",(function(e){var r,n,a;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return r=t.props.store,n=r.me,a=r.notification,e.preventDefault(),s.next=4,M.awrap(n.edit({email:t.state.email}));case 4:s.sent.ok||a.show("Error editing me");case 6:case"end":return s.stop()}}))})),t.state={email:""},t.fetch(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t=this.props.store.me.detail;return e.createElement(Oe,{style:{}},e.createElement(p,{style:je.root},e.createElement("form",{onSubmit:this.handleSubmit,style:je.form},e.createElement(n,{required:!0,label:"Email",type:"email",variant:"outlined",value:this.state.email,onChange:this.handleEmail}),e.createElement(a,{variant:"contained",color:"primary",type:"submit",style:je.button,disabled:t.email===this.state.email},"Save"),e.createElement(a,{variant:"contained",style:je.button,disabled:t.email===this.state.email,onClick:this.handleEmailCancel},"Cancel"))))}}]),r}()),Re={detail:{}},_e=function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.patch("/me",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},Ne=function(){var e;return M.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,M.awrap(pe.get("/me"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},Me={detail:Ae,initial:Re,store:function e(t){var r=this;T(this,e),Y(this,"fetch",(function(){var e,t,n;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M.awrap(Ne());case 3:return e=a.sent,t=X({},e,{ok:!0}),r.setDetail(t),a.abrupt("return",t);case 9:return a.prev=9,a.t0=a.catch(0),n={ok:!1},r.setDetail(X({},Re.detail,{},n)),a.abrupt("return",X({},a.t0,{},n));case 14:case"end":return a.stop()}}),null,null,[[0,9]])})),Y(this,"edit",(function(e){var t,n;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M.awrap(_e(e));case 3:return t=a.sent,n=X({},t,{ok:!0}),r.setDetail(n),a.abrupt("return",n);case 9:return a.prev=9,a.t0=a.catch(0),a.abrupt("return",X({},a.t0,{ok:!1}));case 12:case"end":return a.stop()}}),null,null,[[0,9]])})),this.detail=t[0],this.setDetail=t[1]}},Te={root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"}},Fe={detail:le,initial:{detail:{show:!1,message:""}},store:function e(t){var r=this;T(this,e),Y(this,"show",(function(e){return M.async((function(t){for(;;)switch(t.prev=t.next){case 0:r.setDetail({message:e,show:!0});case 1:case"end":return t.stop()}}))})),Y(this,"close",(function(){return M.async((function(e){for(;;)switch(e.prev=e.next){case 0:r.setDetail({show:!1});case 1:case"end":return e.stop()}}))})),this.detail=t[0],this.setDetail=t[1]}},Ie={detail:function(){return e.createElement(Fe.detail,{style:Te.root},e.createElement("h1",null,"No Such Page"))}};function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,a=!1,s=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){a=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw s}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var He={root:{display:"block",minHeight:"calc(100vh - 65px - 40px)",padding:20},item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},page:{marginLeft:10,marginRight:10},center:X({},{display:"flex",justifyContent:"center",alignItems:"center"}),avatar:{marginRight:10},h1:{marginBottom:30,color:"#3f51b5",small:{margin:0},textAlign:"center"}},Ue=Z(function(t){function r(){var e,t;T(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return Y(U(t=G(this,(e=B(r)).call.apply(e,[this].concat(a)))),"componentDidMount",(function(){var e,r,n,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,M.awrap(Promise.all([t.props.store.role.fetch(t.props.match.params.id),t.props.store.user.fetchAll()]));case 2:e=o.sent,r=qe(e,2),n=r[0],a=r[1],s=t.props.store.notification,n.ok||s.show(n.error),a.ok||s.show(a.error);case 9:case"end":return o.stop()}}))})),Y(U(t),"handleAdmin",(function(){t.props.store.role.edit(t.props.match.params.id,{admin:!t.props.store.role.detail.admin})})),Y(U(t),"handleUserActive",(function(e){return function(r,n){n?t.props.store.role.assign(e.id):t.props.store.role.deassign(e.id)}})),t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t,r=this,n=this.props.store,a=n.role,s=n.user;return t=0===s.list.data.length?null:s.list.data.map((function(t){var n=a.detail.users.filter((function(e){return e.id===t.id})).length>0;return e.createElement(g,{key:t.id,style:He.item,dense:!0,button:!0},e.createElement(w,{style:He.avatar},t.id),e.createElement(E,{primary:t.email}),e.createElement(b,null,e.createElement(x,{onChange:r.handleUserActive(t),checked:n})))})),e.createElement(Oe,{style:{},secure:!0},e.createElement(p,{style:He.root},e.createElement("h1",{style:He.h1.small},a.detail.name),e.createElement(k,null,t)))}}]),r}()),Ge={detail:{users:[]},list:{data:[],pages:0,total:0}},Be=Z(function(t){function r(e){var t;T(this,r),Y(U(t=G(this,B(r).call(this,e))),"componentDidUpdate",(function(e){var r=Number(e.match.params.page||"0"),n=Number(t.props.match.params.page||"0");r!==n&&t.props.store.role.fetchAll(n)})),Y(U(t),"handleClose",(function(){t.setState({open:!1})})),Y(U(t),"handleAdd",(function(){t.setState({open:!0})})),t.state={open:!1};var n=Number(e.match.params.page||"0");return e.store.role.fetchAll(n),t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t=Number(this.props.match.params.page||"0"),r=0!==t?e.createElement(S,{to:1!==t?"/roles/".concat(t-1):"/roles"},e.createElement(a,{variant:"outlined"},"<")):e.createElement(a,{variant:"outlined",disabled:!0},"<"),n=t<this.props.store.role.list.pages-1?e.createElement(S,{to:"/roles/".concat(t+1)},e.createElement(a,{variant:"outlined"},">")):e.createElement(a,{variant:"outlined",disabled:!0},">"),s=this.props.store.role.list.data.map((function(t){return e.createElement(k,{style:He.item,key:t.id},e.createElement(g,{dense:!0,button:!0},e.createElement(w,{style:He.avatar,"data-id":"avatar"},t.id),e.createElement(E,{primary:t.name}),e.createElement(b,null,e.createElement(S,{to:"/role/".concat(t.id)},e.createElement(a,{style:He.details,variant:"outlined",color:"primary"},"Details")))))}));return e.createElement(Oe,{style:{},secure:!0},e.createElement(ae,{open:this.state.open,close:this.handleClose}),e.createElement(p,{style:He.root},s,e.createElement(C,{color:"primary",onClick:this.handleAdd,"data-id":"add"},e.createElement(N,null)),e.createElement("div",{style:He.center},r,e.createElement(w,{style:He.page,"data-id":"page"},String(t)),n)))}}]),r}()),We={assign:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.post("/roles/".concat(e,"/user"),{id:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},create:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.post("/roles",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},deassign:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.delete("/roles/".concat(e,"/user/").concat(t)));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},edit:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.patch("/roles/".concat(e),t));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},fetch:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.get("/roles/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},fetchAll:function(){var e;return M.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=4,M.awrap(pe.get("/roles"));case 4:return e=t.sent,t.abrupt("return",e.data);case 6:case"end":return t.stop()}}))},remove:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.delete("/roles/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))}},ze={detail:Ue,initial:Ge,list:Be,store:function(){function e(t,r){var n=this;T(this,e),Y(this,"fetch",(function(e){var t,r,a;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,M.awrap(We.fetch(e));case 3:return t=s.sent,r=X({},t,{ok:!0}),n.setDetail(r),s.abrupt("return",r);case 9:return s.prev=9,s.t0=s.catch(0),a={ok:!1},n.setDetail(X({},Ge.detail,{},a)),s.abrupt("return",X({},s.t0,{},a));case 14:case"end":return s.stop()}}),null,null,[[0,9]])})),Y(this,"fetchAll",(function(){var e,t,r,a=arguments;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:10,s.prev=2,s.next=5,M.awrap(We.fetchAll(e,t));case 5:return r=s.sent,n.setList(r),s.abrupt("return",X({},r,{ok:!0}));case 10:return s.prev=10,s.t0=s.catch(2),s.abrupt("return",X({},s.t0,{ok:!1}));case 13:case"end":return s.stop()}}),null,null,[[2,10]])})),Y(this,"create",(function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,M.awrap(We.create(e));case 3:return t=r.sent,n.list.data.push(t),r.abrupt("return",X({},t,{ok:!0}));case 8:return r.prev=8,r.t0=r.catch(0),r.abrupt("return",X({},r.t0,{ok:!1}));case 11:case"end":return r.stop()}}),null,null,[[0,8]])})),Y(this,"edit",(function(e,t){var r,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,M.awrap(We.edit(e,t));case 3:return r=o.sent,a=X({},r,{ok:!0}),n.detail.id===e&&n.setDetail(a),(s=X({},n.list)).data.forEach((function(t){t.id===e&&(t.email=r.email,t.active=r.active,t.admin=r.admin)})),n.setList(s),o.abrupt("return",a);case 12:return o.prev=12,o.t0=o.catch(0),o.abrupt("return",X({},o.t0,{ok:!1}));case 15:case"end":return o.stop()}}),null,null,[[0,12]])})),Y(this,"delete",(function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,M.awrap(We.delete(e));case 3:return t=r.sent,r.abrupt("return",X({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",X({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),this.detail=t[0],this.setDetail=t[1],this.list=r[0],this.setList=r[1]}return I(e,[{key:"assign",value:function(e){var t,r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,M.awrap(We.assign(this.detail.id,e));case 3:return t=n.sent,(r=X({},this.detail,{ok:!0})).users.push(t),this.setDetail(r),n.abrupt("return",r);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",X({},n.t0,{ok:!1}));case 13:case"end":return n.stop()}}),null,this,[[0,10]])}},{key:"deassign",value:function(e){var t,r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,M.awrap(We.deassign(this.detail.id,e));case 3:return t=n.sent,(r=X({},this.detail,{ok:!0})).users=this.detail.users.filter((function(e){return e.id!==t.id})),this.setDetail(r),n.abrupt("return",r);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",X({},n.t0,{ok:!1}));case 13:case"end":return n.stop()}}),null,this,[[0,10]])}}]),e}()},Ye={item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},avatar:{marginRight:10},center:X({},{display:"flex",justifyContent:"center",alignItems:"center"}),page:{marginLeft:10,marginRight:10},root:{padding:20,minHeight:"calc(100vh - 65px - 40px)"}},Ke=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"fetch",(function(){var e,r,n,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=t.props.store,o.next=3,M.awrap(Promise.all([e.user.fetch(t.props.match.params.id),e.role.fetchAll()]));case 3:r=o.sent,n=qe(r,2),a=n[0],s=n[1],a.ok||e.notification.show("User error"),s.ok||e.notification.show("Role error");case 9:case"end":return o.stop()}}))})),Y(U(t),"handleRoleActive",(function(e){return function(r,n){n?t.props.store.user.assign(e.id):t.props.store.user.deassign(e.id)}})),t.fetch(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t,r=this,n=this.props.store,a=n.role,s=n.user;return t=0===a.list.data.length?null:a.list.data.map((function(t){var n=s.detail.roles.filter((function(e){return e.id===t.id})).length>0;return e.createElement(g,{key:t.id,style:Ye.item,dense:!0,button:!0},e.createElement(w,{style:Ye.avatar},t.id),e.createElement(E,{primary:t.name}),e.createElement(b,null,e.createElement(x,{onChange:r.handleRoleActive(t),checked:n})))})),e.createElement(Oe,{secure:!0,style:{}},e.createElement(p,{style:Ye.root},"email:  ",e.createElement("span",{"data-id":"email"},s.detail.email),e.createElement(k,null,t)))}}]),r}()),Xe={detail:{email:"",roles:[]},list:{data:[],pages:0,total:0}},Je=Z(function(t){function r(e){var t;return T(this,r),Y(U(t=G(this,B(r).call(this,e))),"fetch",(function(){var e,r,n,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=t.props.store,r=e.notification,n=e.user,o.next=3,M.awrap(n.fetchAll(t.props.match.params.page));case 3:(a=o.sent).ok||(s=he(a),r.show(s.message));case 5:case"end":return o.stop()}}))})),Y(U(t),"handleUserActive",(function(e){return function(){t.props.store.user.edit(e.id,{active:!e.active})}})),t.fetch(),t}return z(r,e.Component),I(r,[{key:"render",value:function(){var t=this,r=Number(this.props.match.params.page||"0"),n=0!==r?e.createElement(S,{to:1!==r?"/users/".concat(r-1):"/users"},e.createElement(a,{variant:"outlined"},"<")):e.createElement(a,{variant:"outlined",disabled:!0},"<"),s=r<this.props.store.user.list.pages-1?e.createElement(S,{to:"/users/".concat(r+1)},e.createElement(a,{variant:"outlined"},">")):e.createElement(a,{variant:"outlined",disabled:!0},">"),o=this.props.store.user.list.data.map((function(r){return e.createElement(k,{style:Ye.item,key:r.id},e.createElement(g,{dense:!0,button:!0},e.createElement(w,{style:Ye.avatar},r.id),e.createElement(E,{primary:r.email}),e.createElement(b,null,e.createElement(x,{onChange:t.handleUserActive(r),checked:r.active,disabled:r.id===t.props.store.me.detail.id}),e.createElement(S,{to:"/user/".concat(r.id)},e.createElement(a,{style:Ye.details,variant:"outlined",color:"primary"},"Details")))))}));return e.createElement(Oe,{secure:!0,style:{}},e.createElement(p,{style:Ye.root},o,e.createElement("div",{style:Ye.center},n,e.createElement(w,{style:Ye.page,"data-id":"page"},String(r)),s)))}}]),r}()),Qe={assign:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.post("/roles/".concat(t,"/user"),{id:e}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},deassign:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.delete("/roles/".concat(t,"/user/").concat(e)));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},create:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.post("/users",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},edit:function(e,t){var r;return M.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,M.awrap(pe.patch("/users/".concat(e),t));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},fetch:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.get("/users/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},fetchAll:function(){var e,t,r,n=arguments;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:0,t=n.length>1&&void 0!==n[1]?n[1]:10,a.next=4,M.awrap(pe.get("/users",{headers:{Page:e,PerPage:t}}));case 4:return r=a.sent,a.abrupt("return",r.data);case 6:case"end":return a.stop()}}))},remove:function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,M.awrap(pe.delete("/users/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))}},Ve={detail:Ke,initial:Xe,list:Je,store:function e(t,r){var n=this;T(this,e),Y(this,"fetch",(function(e){var t,r,a;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,M.awrap(Qe.fetch(e));case 3:return t=s.sent,r=X({},t,{ok:!0}),n.setDetail(r),s.abrupt("return",r);case 9:return s.prev=9,s.t0=s.catch(0),a={ok:!1},n.setDetail(X({},Xe.detail,{},a)),s.abrupt("return",X({},s.t0,{},a));case 14:case"end":return s.stop()}}),null,null,[[0,9]])})),Y(this,"fetchAll",(function(){var e,t,r,a=arguments;return M.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:10,s.prev=2,s.next=5,M.awrap(Qe.fetchAll(e,t));case 5:return r=s.sent,n.setList(r),s.abrupt("return",X({},r,{ok:!0}));case 10:return s.prev=10,s.t0=s.catch(2),s.abrupt("return",X({},s.t0,{ok:!1}));case 13:case"end":return s.stop()}}),null,null,[[2,10]])})),Y(this,"create",(function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,M.awrap(Qe.create(e));case 3:return t=r.sent,r.abrupt("return",X({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",X({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),Y(this,"edit",(function(e,t){var r,a,s;return M.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,M.awrap(Qe.edit(e,t));case 3:return r=o.sent,a=X({},r,{ok:!0}),n.detail.id===e&&n.setDetail(a),(s=X({},n.list)).data.forEach((function(t){t.id===e&&(t.email=r.email,t.active=r.active,t.admin=r.admin)})),n.setList(s),o.abrupt("return",a);case 12:return o.prev=12,o.t0=o.catch(0),o.abrupt("return",X({},o.t0,{ok:!1}));case 15:case"end":return o.stop()}}),null,null,[[0,12]])})),Y(this,"delete",(function(e){var t;return M.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,M.awrap(Qe.delete(e));case 3:return t=r.sent,r.abrupt("return",X({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",X({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),Y(this,"assign",(function(e){var t,r;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M.awrap(Qe.assign(n.detail.id,e));case 3:return t=a.sent,(r=X({},n.detail,{ok:!0})).roles.push(t),n.setDetail(r),a.abrupt("return",r);case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",X({},a.t0,{ok:!1}));case 13:case"end":return a.stop()}}),null,null,[[0,10]])})),Y(this,"deasign",(function(e){var t,r;return M.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,M.awrap(Qe.deassign(n.detail.id,e));case 3:return t=a.sent,(r=X({},n.detail,{ok:!0})).roles=n.detail.roles.filter((function(e){return e.id!==t.id})),n.setDetail(r),a.abrupt("return",r);case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",X({},a.t0,{ok:!1}));case 13:case"end":return a.stop()}}),null,null,[[0,10]])})),this.detail=t[0],this.setDetail=t[1],this.list=r[0],this.setList=r[1]}};export{Ce as Auth,Le as Dashboard,Me,Ie as NoPage,ze as Role,V as Store,Ve as User,Z as withStore};
//# sourceMappingURL=index.es.js.map
