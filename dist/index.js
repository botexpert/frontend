"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react")),core=require("@material-ui/core"),reactRouterDom=require("react-router-dom"),axios=_interopDefault(require("axios")),CloseIcon=_interopDefault(require("@material-ui/icons/Clear")),DashboardIcon=_interopDefault(require("@material-ui/icons/Dashboard")),MeIcon=_interopDefault(require("@material-ui/icons/AccountCircle")),ReorderIcon=_interopDefault(require("@material-ui/icons/Reorder")),UserIcon=_interopDefault(require("@material-ui/icons/PeopleOutline")),RoleIcon=_interopDefault(require("@material-ui/icons/People")),AddIcon=_interopDefault(require("@material-ui/icons/Add"));function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var runtime_1=createCommonjsModule((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",i=a.toStringTag||"@@toStringTag";function c(e,t,r,n){var a=t&&t.prototype instanceof m?t:m,o=Object.create(a.prototype),s=new S(n||[]);return o._invoke=function(e,t,r){var n=u;return function(a,o){if(n===d)throw new Error("Generator is already running");if(n===h){if("throw"===a)throw o;return $()}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var i=x(s,r);if(i){if(i===f)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===u)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?h:p,c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=h,r.method="throw",r.arg=c.arg)}}}(e,r,s),o}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u="suspendedStart",p="suspendedYield",d="executing",h="completed",f={};function m(){}function y(){}function v(){}var g={};g[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(k([])));w&&w!==r&&n.call(w,o)&&(g=w);var _=v.prototype=m.prototype=Object.create(g);function R(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e){var t;this._invoke=function(r,a){function o(){return new Promise((function(t,o){!function t(r,a,o,s){var i=l(e[r],e,a);if("throw"!==i.type){var c=i.arg,u=c.value;return u&&"object"==typeof u&&n.call(u,"__await")?Promise.resolve(u.__await).then((function(e){t("next",e,o,s)}),(function(e){t("throw",e,o,s)})):Promise.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return t("throw",e,o,s)}))}s(i.arg)}(r,a,t,o)}))}return t=t?t.then(o,o):o()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var a=l(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,f;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,f):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function k(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:$}}function $(){return{value:t,done:!0}}return y.prototype=_.constructor=v,v.constructor=y,v[i]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},R(E.prototype),E.prototype[s]=function(){return this},e.AsyncIterator=E,e.async=function(t,r,n,a){var o=new E(c(t,r,n,a));return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},R(_),_[i]="Generator",_[o]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=k,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return i.type="throw",i.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;P(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:k(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),f}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}})),regenerator=runtime_1;function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof2(e){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(e){return _typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof2(e)})(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){_defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var flex={display:"flex",justifyContent:"center",alignItems:"center"},styles={root:_objectSpread2({},flex,{height:"100vh"}),paper:_objectSpread2({},flex,{width:400,height:400,textAlign:"center"}),button:_objectSpread2({},flex,{marginBottom:10}),form:_objectSpread2({},flex,{flexDirection:"column"})},Store=React.createContext({}),withStore=function(e){return function(t){return React.createElement(Store.Consumer,null,(function(r){return React.createElement(e,Object.assign({},t,{store:r}))}))}},ProtectedComponent=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"protect",(function(){var e,t,n;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=r.props.store,t=e.auth,n=e.me,a.next=3,regenerator.awrap(t.refresh());case 3:a.sent.ok?n.detail.id||n.fetch():r.props.secure&&r.props.store.history.push("/");case 5:case"end":return a.stop()}}))})),r.protect(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return null}}]),t}();ProtectedComponent.defaultProps={secure:!1};var Protected=withStore(ProtectedComponent),center={display:"flex",justifyContent:"center",alignItems:"center"},styles$1={root:_objectSpread2({},center,{height:"100vh",width:"100vw"}),content:{minHeight:300,minWidth:300},form:_objectSpread2({},center,{flexDirection:"column"})},RoleCreate=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleName",(function(e){r.setState({name:e.target.value})})),_defineProperty(_assertThisInitialized(r),"handleSubmit",(function(e){var t,n,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e.preventDefault(),t=r.state.name,n=r.props.store,a=n.role,o=n.notification,s.next=5,regenerator.awrap(a.create({name:t}));case 5:s.sent.ok?o.show("Role created"):o.show("Error"),r.props.close();case 8:case"end":return s.stop()}}))})),r.state={name:""},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(core.Dialog,{onClose:this.props.close,open:this.props.open},React.createElement(core.DialogTitle,null,"Create new role"),React.createElement("form",{onSubmit:this.handleSubmit,style:styles$1.form},React.createElement(core.TextField,{autoFocus:!0,required:!0,fullWidth:!0,label:"Name",variant:"outlined",value:this.state.name,onChange:this.handleName}),React.createElement(core.Button,{fullWidth:!0,type:"submit",color:"primary",variant:"contained"},"Create"),React.createElement(core.Button,{fullWidth:!0,color:"secondary",variant:"outlined",onClick:this.props.close},"Cancel")))}}]),t}();RoleCreate.defaultProps={open:!1};var RoleCreate$1=withStore(RoleCreate),styles$2={card:{minWidth:120,marginRight:10,marginLeft:10}},RoleList=function(e){function t(e){var r;return _classCallCheck(this,t),r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),e.store.role.fetchAll(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(core.Badge,{color:"primary",badgeContent:this.props.store.role.list.total},React.createElement(core.Card,{style:styles$2.card},React.createElement(core.CardContent,null,React.createElement(core.Typography,{variant:"h5","data-id":"roles"},"Roles"),React.createElement(core.Typography,{color:"textSecondary"},"All roles")),React.createElement(core.CardActions,null,React.createElement(reactRouterDom.Link,{to:"/roles"},React.createElement(core.Button,{variant:"outlined",size:"small"},"Explore")))))}}]),t}(),RoleList$1=withStore(RoleList),styles$3={card:{minWidth:120,marginRight:10,marginLeft:10}},UserList=function(e){function t(e){var r;return _classCallCheck(this,t),r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e)),e.store.user.fetchAll(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(core.Badge,{color:"primary",badgeContent:this.props.store.user.list.total},React.createElement(core.Card,{style:styles$3.card},React.createElement(core.CardContent,null,React.createElement(core.Typography,{variant:"h5","data-id":"users"},"Users"),React.createElement(core.Typography,{color:"textSecondary"},"All users")),React.createElement(core.CardActions,null,React.createElement(reactRouterDom.Link,{to:"/users"},React.createElement(core.Button,{variant:"outlined",size:"small"},"Explore")))))}}]),t}(),UserList$1=withStore(UserList),EmptyTemplate=function(e){var t=e.store.notification;return React.createElement("div",{style:e.style},React.createElement(Protected,{secure:e.secure}),e.children,React.createElement(core.Snackbar,{autoHideDuration:5e3,anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t.detail.show,onClose:t.close,message:t.detail.message,action:React.createElement(core.Button,{color:"secondary",size:"small",onClick:t.close},"CLOSE")}))};EmptyTemplate.defaultProps={children:null,secure:!1,style:{padding:20}};var detail=withStore(EmptyTemplate),API_ROOT="/api/v0",rest=axios.create({baseURL:API_ROOT,withCredentials:!0}),getCookie=function(e){var t="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===t.length)return t.pop().split(";").shift()};rest.interceptors.request.use((function(e){var t="/auth/refresh"===e.url?"csrf_refresh_token":"csrf_access_token",r=getCookie(t);return e.headers.withCredentials=!0,r&&(e.headers["X-CSRF-TOKEN"]=r),e}),(function(e){return Promise.reject(e)}));var errors=function(e){var t=e.response&&e.response.data?e.response.data:{};return t.message||(t.msg?t.message=t.msg:t.statusText?t.message=t.statusText:t.status&&(t.message=t.status)),t.errors&&Object.getOwnPropertyNames(t.errors).forEach((function(e){"message"!==e&&(t.errors[e]=t.errors[e].join(" "))})),t},ChangePassword=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleSubmit",(function(e){var t,n,a,o,s,i;return regenerator.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e.preventDefault(),t=r.state.password,n=r.props.store,a=n.auth,o=n.notification,c.next=5,regenerator.awrap(a.changePassword(t,r.props.match.params.token));case 5:(s=c.sent).ok?o.show("You can login with your new password"):(i=errors(s),o.show(i.message));case 7:case"end":return c.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handlePassword",(function(e){r.setState({password:e.target.value})})),r.state={password:""},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(detail,{style:{}},React.createElement("div",{style:styles.root},React.createElement(core.Paper,{style:styles.paper},React.createElement("div",null,React.createElement("h1",null,"Reset Password"),React.createElement("form",{style:styles.form,onSubmit:this.handleSubmit},React.createElement("div",null,React.createElement(core.TextField,{required:!0,autoFocus:!0,label:"Password","data-id":"password",value:this.state.password,onChange:this.handlePassword,type:"password"})),React.createElement("div",{style:styles.button},React.createElement(core.Button,{variant:"contained",type:"submit"},"Reset Password")))))))}}]),t}(),changePassword=withStore(ChangePassword),initial={detail:{refreshing:!1}},Login=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleSubmit",(function(e){var t,n,a,o,s,i,c,l,u;return regenerator.async((function(p){for(;;)switch(p.prev=p.next){case 0:return e.preventDefault(),t=r.props.store,n=t.auth,a=t.history,o=t.notification,s=r.state,i=s.email,c=s.password,p.next=5,regenerator.awrap(n.login(i,c));case 5:(l=p.sent).ok?(a.push("/dashboard"),n.refresh()):(u=errors(l),o.show(u.message));case 7:case"end":return p.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleEmail",(function(e){r.setState({email:e.target.value})})),_defineProperty(_assertThisInitialized(r),"handlePassword",(function(e){r.setState({password:e.target.value})})),r.state={email:"",password:""},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(detail,{style:{}},React.createElement("div",{style:styles.root},React.createElement(core.Paper,{style:styles.paper},React.createElement("div",null,React.createElement("h1",null,"Login"),React.createElement("form",{style:styles.form,onSubmit:this.handleSubmit},React.createElement("div",null,React.createElement(core.TextField,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",value:this.state.email,onChange:this.handleEmail,type:"email"})),React.createElement("div",null,React.createElement(core.TextField,{required:!0,label:"Password",type:"password",margin:"normal","data-id":"password",value:this.state.password,onChange:this.handlePassword})),React.createElement("div",{style:styles.button},React.createElement(core.Button,{variant:"contained",type:"submit"},"Login")),React.createElement(reactRouterDom.Link,{to:"/reset"},"forgot password?"))))))}}]),t}(),login=withStore(Login),Register=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleSubmit",(function(e){var t,n,a,o,s,i,c;return regenerator.async((function(l){for(;;)switch(l.prev=l.next){case 0:if(e.preventDefault(),t=r.props.store,n=t.auth,a=t.notification,o=r.state,s=o.password,i=o.repeatPassword,s===i){l.next=6;break}return a.show("Passwords must match!"),l.abrupt("return");case 6:return l.next=8,regenerator.awrap(n.register(r.state.email,r.state.password));case 8:(c=l.sent).ok?a.show(React.createElement("div",null,"You are now registered! Once admin approves your account you should be able to  ",React.createElement(reactRouterDom.Link,{to:"/login"},"login"))):a.show(c.error),r.setState({password:"",repeatPassword:""});case 11:case"end":return l.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleEmail",(function(e){r.setState({email:e.target.value})})),_defineProperty(_assertThisInitialized(r),"handlePassword",(function(e){r.setState({password:e.target.value})})),_defineProperty(_assertThisInitialized(r),"handleRepeatPassword",(function(e){r.setState({repeatPassword:e.target.value})})),r.state={email:"",password:"",repeatPassword:""},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(detail,{style:{}},React.createElement("div",{style:styles.root},React.createElement(core.Paper,{style:styles.paper},React.createElement("div",null,React.createElement("h1",null,"Register"),React.createElement("form",{style:styles.form,onSubmit:this.handleSubmit},React.createElement("div",null,React.createElement(core.TextField,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",onChange:this.handleEmail,value:this.state.email,type:"email"})),React.createElement("div",null,React.createElement(core.TextField,{required:!0,label:"Password",type:"password",margin:"normal","data-id":"password",onChange:this.handlePassword,value:this.state.password})),React.createElement("div",null,React.createElement(core.TextField,{required:!0,label:"Repeat Password",type:"password",margin:"normal","data-id":"repeatPassword",onChange:this.handleRepeatPassword,value:this.state.repeatPassword})),React.createElement("div",{style:styles.button},React.createElement(core.Button,{variant:"contained",type:"submit"},"Register")))))))}}]),t}(),register=withStore(Register),Reset=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleSubmit",(function(e){var t,n,a,o,s,i;return regenerator.async((function(c){for(;;)switch(c.prev=c.next){case 0:return e.preventDefault(),t=r.state.email,n=r.props.store,a=n.auth,o=n.notification,c.next=5,regenerator.awrap(a.reset(t));case 5:(s=c.sent).ok?o.show("Email with instructions sent to ".concat(t)):(i=errors(s),o.show(i.message));case 7:case"end":return c.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleEmail",(function(e){r.setState({email:e.target.value})})),r.state={email:""},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){return React.createElement(detail,{style:{}},React.createElement("div",{style:styles.root},React.createElement(core.Paper,{style:styles.paper},React.createElement("div",null,React.createElement("h1",null,"Reset Password"),React.createElement("form",{style:styles.form,onSubmit:this.handleSubmit},React.createElement("div",null,React.createElement(core.TextField,{required:!0,autoFocus:!0,label:"Email",margin:"normal","data-id":"email",value:this.state.email,onChange:this.handleEmail,type:"email"})),React.createElement("div",{style:styles.button},React.createElement(core.Button,{variant:"contained",type:"submit"},"Reset Password")))))))}}]),t}(),reset=withStore(Reset),service={login:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.post("/auth/login",{email:e,password:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},logout:function(){var e;return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regenerator.awrap(rest.post("/auth/logout",{}));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},refresh:function(){var e;return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regenerator.awrap(rest.post("/auth/refresh",{}));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))},register:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.post("/auth/register",{email:e,password:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},reset:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.post("/auth/reset/request",{email:e}));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},changePassword:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.post("/auth/reset",{password:e,token:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))}},AuthStore=function e(t){var r=this;_classCallCheck(this,e),_defineProperty(this,"timeoutHandler",null),_defineProperty(this,"login",(function(e,t){var n,a,o,s,i;return regenerator.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,regenerator.awrap(service.login(e,t));case 3:return n=c.sent,a=n.accessExpire,o=n.refreshExpire,s={accessExpire:a,refreshExpire:o,ok:!0},r.setDetail(s),c.abrupt("return",s);case 10:return c.prev=10,c.t0=c.catch(0),i=_objectSpread2({},initial,{ok:!1}),r.setDetail(i),c.abrupt("return",_objectSpread2({},c.t0,{},i));case 15:case"end":return c.stop()}}),null,null,[[0,10]])})),_defineProperty(this,"logout",(function(){var e,t;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regenerator.awrap(service.logout());case 3:return e={},r.setDetail(e),n.abrupt("return",e);case 8:return n.prev=8,n.t0=n.catch(0),t={ok:!1},r.setDetail(t),n.abrupt("return",_objectSpread2({},n.t0,{},t));case 13:case"end":return n.stop()}}),null,null,[[0,8]])})),_defineProperty(this,"refresh",(function(){var e,t,n,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:if(!r.detail.refreshing){s.next=2;break}return s.abrupt("return",_objectSpread2({},r.detail,{ok:!0}));case 2:return s.prev=2,s.next=5,regenerator.awrap(service.refresh());case 5:return e=s.sent,t=e.accessExpire,n=e.refreshExpire,a=_objectSpread2({},r.detail,{accessExpire:t,refreshExpire:n,refreshing:!0,ok:!0}),r.setDetail(a),clearTimeout(r.timeoutHandler),r.timeoutHandler=setTimeout((function(){r.setDetail(_objectSpread2({},r.detail,{refreshing:!1})),r.refresh()}),1e3*a.accessExpire),s.abrupt("return",a);case 14:return s.prev=14,s.t0=s.catch(2),clearTimeout(r.timeoutHandler),r.timeoutHandler=null,o=_objectSpread2({},initial,{ok:!1}),r.setDetail(o),s.abrupt("return",_objectSpread2({},s.t0,{},o));case 21:case"end":return s.stop()}}),null,null,[[2,14]])})),_defineProperty(this,"register",(function(e,t){var n,a,o,s,i;return regenerator.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,regenerator.awrap(service.register(e,t));case 3:return n=c.sent,a=n.accessExpire,o=n.refreshExpire,s={accessExpire:a,refreshExpire:o,ok:!0},r.setDetail(s),c.abrupt("return",s);case 10:return c.prev=10,c.t0=c.catch(0),i=_objectSpread2({},initial,{ok:!1}),r.setDetail(i),c.abrupt("return",_objectSpread2({},c.t0,{},i));case 15:case"end":return c.stop()}}),null,null,[[0,10]])})),_defineProperty(this,"reset",(function(e){var t,r,n;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regenerator.awrap(service.reset(e));case 3:return t=a.sent,r=_objectSpread2({},t,{ok:!0}),a.abrupt("return",r);case 8:return a.prev=8,a.t0=a.catch(0),n=_objectSpread2({},a.t0,{ok:!1}),a.abrupt("return",n);case 12:case"end":return a.stop()}}),null,null,[[0,8]])})),_defineProperty(this,"changePassword",(function(e,t){var r,n,a;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regenerator.awrap(service.changePassword(e,t));case 3:return r=o.sent,n=_objectSpread2({},r,{ok:!0}),o.abrupt("return",n);case 8:return o.prev=8,o.t0=o.catch(0),a=_objectSpread2({},o.t0,{ok:!1}),o.abrupt("return",a);case 12:case"end":return o.stop()}}),null,null,[[0,8]])})),this.detail=t[0],this.setDetail=t[1]},index={changePassword:changePassword,initial:initial,login:login,register:register,reset:reset,store:AuthStore},styles$4={flex:{flex:1},menu:{width:200},login:{color:"white"}},Template=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"handleLogout",(function(){var e;return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:return e=r.props.store.auth,t.next=3,regenerator.awrap(e.logout());case 3:void 0===t.sent.ok&&r.props.history.push("/");case 5:case"end":return t.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleMenuOpen",(function(){r.setState({showMenu:!0})})),_defineProperty(_assertThisInitialized(r),"handleMenuClose",(function(){r.setState({showMenu:!1})})),r.state={showMenu:!1},r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this.props.store.auth,t=React.createElement(reactRouterDom.Link,{to:"/login",style:styles$4.login},React.createElement(core.Button,{color:"inherit"},"Login")),r=React.createElement(core.Button,{color:"inherit",onClick:this.handleLogout},"Logout"),n=e.detail.ok?r:t,a=e.detail.ok?[React.createElement(reactRouterDom.Link,{to:"/dashboard",key:"dashboard"},React.createElement(core.MenuItem,null,React.createElement(core.ListItemIcon,null,React.createElement(DashboardIcon,null)),"Dashboard")),React.createElement(reactRouterDom.Link,{to:"/me",key:"me"},React.createElement(core.MenuItem,null,React.createElement(core.ListItemIcon,null,React.createElement(MeIcon,null)),"Me")),React.createElement(reactRouterDom.Link,{to:"/users",key:"users"},React.createElement(core.MenuItem,null,React.createElement(core.ListItemIcon,null,React.createElement(UserIcon,null)),"Users")),React.createElement(reactRouterDom.Link,{to:"/roles",key:"roles"},React.createElement(core.MenuItem,null,React.createElement(core.ListItemIcon,null,React.createElement(RoleIcon,null)),"Roles"))]:null;return React.createElement("div",null,React.createElement(core.AppBar,{position:"static"},React.createElement(core.Toolbar,null,React.createElement(core.Typography,{variant:"h5",color:"inherit",style:styles$4.flex},React.createElement(core.IconButton,{color:"inherit",onClick:this.handleMenuOpen},React.createElement(ReorderIcon,null)),React.createElement(reactRouterDom.Link,{to:"/","data-id":"app"},"Freenit")),n)),React.createElement(detail,{secure:this.props.secure,style:this.props.style},this.props.children,React.createElement(core.Drawer,{open:this.state.showMenu,onClose:this.handleMenuClose},React.createElement(core.AppBar,{position:"static"},React.createElement(core.Toolbar,null,React.createElement(core.Typography,{variant:"h5",color:"inherit",style:styles$4.flex}," "),React.createElement(core.IconButton,{color:"inherit",onClick:this.handleMenuClose},React.createElement(CloseIcon,null)))),React.createElement("div",{role:"button",onClick:this.handleMenuClose,style:styles$4.menu,tabIndex:0,onKeyDown:this.handleMenuClose},a))))}}]),t}();Template.defaultProps={children:null,secure:!1,style:{}};var Template$1=reactRouterDom.withRouter(withStore(Template)),styles$5={root:{display:"flex",justifyContent:"space-between",alignItems:"center"},template:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 64px - 40px)",padding:20}},Dashboard=function(){return React.createElement(Template$1,{secure:!0,style:styles$5.template},React.createElement("div",{style:styles$5.root},React.createElement(RoleList$1,null),React.createElement(UserList$1,null)))},index$1={detail:Dashboard},center$1={display:"flex",justifyContent:"center",alignItems:"center"},styles$6={root:{display:"block",minHeight:"calc(100vh - 65px - 40px)",padding:20},item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},page:{marginLeft:10,marginRight:10},center:_objectSpread2({},center$1),avatar:{marginRight:10},h1:{marginBottom:30,color:"#3f51b5",small:{margin:0},textAlign:"center"},form:{display:"flex"},button:{marginLeft:10,width:80}},Me=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"fetch",(function(){var e,t,n;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=r.props.store,a.next=3,regenerator.awrap(e.me.fetch());case 3:(t=a.sent).ok?r.setState({email:t.email}):(n=errors(t),e.notification.show(n.message));case 5:case"end":return a.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleEmail",(function(e){r.setState({email:e.target.value})})),_defineProperty(_assertThisInitialized(r),"handleEmailCancel",(function(){r.setState({email:r.props.store.me.detail.email})})),_defineProperty(_assertThisInitialized(r),"handleSubmit",(function(e){var t,n,a;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=r.props.store,n=t.me,a=t.notification,e.preventDefault(),o.next=4,regenerator.awrap(n.edit({email:r.state.email}));case 4:o.sent.ok||a.show("Error editing me");case 6:case"end":return o.stop()}}))})),r.state={email:""},r.fetch(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this.props.store.me.detail;return React.createElement(Template$1,{style:{}},React.createElement(core.Paper,{style:styles$6.root},React.createElement("form",{onSubmit:this.handleSubmit,style:styles$6.form},React.createElement(core.TextField,{required:!0,label:"Email",type:"email",variant:"outlined",value:this.state.email,onChange:this.handleEmail}),React.createElement(core.Button,{variant:"contained",color:"primary",type:"submit",style:styles$6.button,disabled:e.email===this.state.email},"Save"),React.createElement(core.Button,{variant:"contained",style:styles$6.button,disabled:e.email===this.state.email,onClick:this.handleEmailCancel},"Cancel"))))}}]),t}(),detail$1=withStore(Me),initial$1={detail:{}},service$1={edit:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.patch("/me",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},fetch:function(){var e;return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,regenerator.awrap(rest.get("/me"));case 2:return e=t.sent,t.abrupt("return",e.data);case 4:case"end":return t.stop()}}))}},MeStore=function e(t){var r=this;_classCallCheck(this,e),_defineProperty(this,"fetch",(function(){var e,t,n;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regenerator.awrap(service$1.fetch());case 3:return e=a.sent,t=_objectSpread2({},e,{ok:!0}),r.setDetail(t),a.abrupt("return",t);case 9:return a.prev=9,a.t0=a.catch(0),n={ok:!1},r.setDetail(_objectSpread2({},initial$1.detail,{},n)),a.abrupt("return",_objectSpread2({},a.t0,{},n));case 14:case"end":return a.stop()}}),null,null,[[0,9]])})),_defineProperty(this,"edit",(function(e){var t,n;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regenerator.awrap(service$1.edit(e));case 3:return t=a.sent,n=_objectSpread2({},t,{ok:!0}),r.setDetail(n),a.abrupt("return",n);case 9:return a.prev=9,a.t0=a.catch(0),a.abrupt("return",_objectSpread2({},a.t0,{ok:!1}));case 12:case"end":return a.stop()}}),null,null,[[0,9]])})),this.detail=t[0],this.setDetail=t[1]},index$2={detail:detail$1,initial:initial$1,store:MeStore},styles$7={root:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"}},initial$2={detail:{show:!1,message:""}},NotificationStore=function e(t){var r=this;_classCallCheck(this,e),_defineProperty(this,"show",(function(e){return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:r.setDetail({message:e,show:!0});case 1:case"end":return t.stop()}}))})),_defineProperty(this,"close",(function(){return regenerator.async((function(e){for(;;)switch(e.prev=e.next){case 0:r.setDetail({show:!1});case 1:case"end":return e.stop()}}))})),this.detail=t[0],this.setDetail=t[1]},Template$2={detail:detail,initial:initial$2,store:NotificationStore},NoPage=function(){return React.createElement(Template$2.detail,{style:styles$7.root},React.createElement("h1",null,"No Such Page"))},index$3={detail:NoPage};function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,a=!1,o=void 0;try{for(var s,i=e[Symbol.iterator]();!(n=(s=i.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(a)throw o}}return r}}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}var center$2={display:"flex",justifyContent:"center",alignItems:"center"},styles$8={root:{display:"block",minHeight:"calc(100vh - 65px - 40px)",padding:20},item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},page:{marginLeft:10,marginRight:10},center:_objectSpread2({},center$2),avatar:{marginRight:10},h1:{marginBottom:30,color:"#3f51b5",small:{margin:0},textAlign:"center"}},RoleDetail=function(e){function t(){var e,r;_classCallCheck(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return _defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,(e=_getPrototypeOf(t)).call.apply(e,[this].concat(a)))),"componentDidMount",(function(){var e,t,n,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,regenerator.awrap(Promise.all([r.props.store.role.fetch(r.props.match.params.id),r.props.store.user.fetchAll()]));case 2:e=s.sent,t=_slicedToArray(e,2),n=t[0],a=t[1],o=r.props.store.notification,n.ok||o.show(n.error),a.ok||o.show(a.error);case 9:case"end":return s.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleAdmin",(function(){r.props.store.role.edit(r.props.match.params.id,{admin:!r.props.store.role.detail.admin})})),_defineProperty(_assertThisInitialized(r),"handleUserActive",(function(e){return function(t,n){n?r.props.store.role.assign(e.id):r.props.store.role.deassign(e.id)}})),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e,t=this,r=this.props.store,n=r.role,a=r.user;return e=0===a.list.data.length?null:a.list.data.map((function(e){var r=n.detail.users.filter((function(t){return t.id===e.id})).length>0;return React.createElement(core.ListItem,{key:e.id,style:styles$8.item,dense:!0,button:!0},React.createElement(core.Avatar,{style:styles$8.avatar},e.id),React.createElement(core.ListItemText,{primary:e.email}),React.createElement(core.ListItemSecondaryAction,null,React.createElement(core.Switch,{onChange:t.handleUserActive(e),checked:r})))})),React.createElement(Template$1,{style:{},secure:!0},React.createElement(core.Paper,{style:styles$8.root},React.createElement("h1",{style:styles$8.h1.small},n.detail.name),React.createElement(core.List,null,e)))}}]),t}(),detail$2=withStore(RoleDetail),initial$3={detail:{users:[]},list:{data:[],pages:0,total:0}},RoleList$2=function(e){function t(e){var r;_classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"componentDidUpdate",(function(e){var t=Number(e.match.params.page||"0"),n=Number(r.props.match.params.page||"0");t!==n&&r.props.store.role.fetchAll(n)})),_defineProperty(_assertThisInitialized(r),"handleClose",(function(){r.setState({open:!1})})),_defineProperty(_assertThisInitialized(r),"handleAdd",(function(){r.setState({open:!0})})),r.state={open:!1};var n=Number(e.match.params.page||"0");return e.store.role.fetchAll(n),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=Number(this.props.match.params.page||"0"),t=0!==e?React.createElement(reactRouterDom.Link,{to:1!==e?"/roles/".concat(e-1):"/roles"},React.createElement(core.Button,{variant:"outlined"},"<")):React.createElement(core.Button,{variant:"outlined",disabled:!0},"<"),r=e<this.props.store.role.list.pages-1?React.createElement(reactRouterDom.Link,{to:"/roles/".concat(e+1)},React.createElement(core.Button,{variant:"outlined"},">")):React.createElement(core.Button,{variant:"outlined",disabled:!0},">"),n=this.props.store.role.list.data.map((function(e){return React.createElement(core.List,{style:styles$8.item,key:e.id},React.createElement(core.ListItem,{dense:!0,button:!0},React.createElement(core.Avatar,{style:styles$8.avatar,"data-id":"avatar"},e.id),React.createElement(core.ListItemText,{primary:e.name}),React.createElement(core.ListItemSecondaryAction,null,React.createElement(reactRouterDom.Link,{to:"/role/".concat(e.id)},React.createElement(core.Button,{style:styles$8.details,variant:"outlined",color:"primary"},"Details")))))}));return React.createElement(Template$1,{style:{},secure:!0},React.createElement(RoleCreate$1,{open:this.state.open,close:this.handleClose}),React.createElement(core.Paper,{style:styles$8.root},n,React.createElement(core.Fab,{color:"primary",onClick:this.handleAdd,"data-id":"add"},React.createElement(AddIcon,null)),React.createElement("div",{style:styles$8.center},t,React.createElement(core.Avatar,{style:styles$8.page,"data-id":"page"},String(e)),r)))}}]),t}(),list=withStore(RoleList$2),service$2={assign:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.post("/roles/".concat(e,"/user"),{id:t}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},create:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.post("/roles",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},deassign:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.delete("/roles/".concat(e,"/user/").concat(t)));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},edit:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.patch("/roles/".concat(e),t));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},fetch:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.get("/roles/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},fetchAll:function(){var e;return regenerator.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=4,regenerator.awrap(rest.get("/roles"));case 4:return e=t.sent,t.abrupt("return",e.data);case 6:case"end":return t.stop()}}))},remove:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.delete("/roles/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))}},RoleStore=function(){function e(t,r){var n=this;_classCallCheck(this,e),_defineProperty(this,"fetch",(function(e){var t,r,a;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regenerator.awrap(service$2.fetch(e));case 3:return t=o.sent,r=_objectSpread2({},t,{ok:!0}),n.setDetail(r),o.abrupt("return",r);case 9:return o.prev=9,o.t0=o.catch(0),a={ok:!1},n.setDetail(_objectSpread2({},initial$3.detail,{},a)),o.abrupt("return",_objectSpread2({},o.t0,{},a));case 14:case"end":return o.stop()}}),null,null,[[0,9]])})),_defineProperty(this,"fetchAll",(function(){var e,t,r,a=arguments;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:10,o.prev=2,o.next=5,regenerator.awrap(service$2.fetchAll(e,t));case 5:return r=o.sent,n.setList(r),o.abrupt("return",_objectSpread2({},r,{ok:!0}));case 10:return o.prev=10,o.t0=o.catch(2),o.abrupt("return",_objectSpread2({},o.t0,{ok:!1}));case 13:case"end":return o.stop()}}),null,null,[[2,10]])})),_defineProperty(this,"create",(function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regenerator.awrap(service$2.create(e));case 3:return t=r.sent,n.list.data.push(t),r.abrupt("return",_objectSpread2({},t,{ok:!0}));case 8:return r.prev=8,r.t0=r.catch(0),r.abrupt("return",_objectSpread2({},r.t0,{ok:!1}));case 11:case"end":return r.stop()}}),null,null,[[0,8]])})),_defineProperty(this,"edit",(function(e,t){var r,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regenerator.awrap(service$2.edit(e,t));case 3:return r=s.sent,a=_objectSpread2({},r,{ok:!0}),n.detail.id===e&&n.setDetail(a),(o=_objectSpread2({},n.list)).data.forEach((function(t){t.id===e&&(t.email=r.email,t.active=r.active,t.admin=r.admin)})),n.setList(o),s.abrupt("return",a);case 12:return s.prev=12,s.t0=s.catch(0),s.abrupt("return",_objectSpread2({},s.t0,{ok:!1}));case 15:case"end":return s.stop()}}),null,null,[[0,12]])})),_defineProperty(this,"delete",(function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regenerator.awrap(service$2.delete(e));case 3:return t=r.sent,r.abrupt("return",_objectSpread2({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",_objectSpread2({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),this.detail=t[0],this.setDetail=t[1],this.list=r[0],this.setList=r[1]}return _createClass(e,[{key:"assign",value:function(e){var t,r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regenerator.awrap(service$2.assign(this.detail.id,e));case 3:return t=n.sent,(r=_objectSpread2({},this.detail,{ok:!0})).users.push(t),this.setDetail(r),n.abrupt("return",r);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",_objectSpread2({},n.t0,{ok:!1}));case 13:case"end":return n.stop()}}),null,this,[[0,10]])}},{key:"deassign",value:function(e){var t,r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,regenerator.awrap(service$2.deassign(this.detail.id,e));case 3:return t=n.sent,(r=_objectSpread2({},this.detail,{ok:!0})).users=this.detail.users.filter((function(e){return e.id!==t.id})),this.setDetail(r),n.abrupt("return",r);case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",_objectSpread2({},n.t0,{ok:!1}));case 13:case"end":return n.stop()}}),null,this,[[0,10]])}}]),e}(),index$4={detail:detail$2,initial:initial$3,list:list,store:RoleStore},center$3={display:"flex",justifyContent:"center",alignItems:"center"},styles$9={item:{marginBottom:5,backgroundColor:"#eee"},details:{marginRight:20},avatar:{marginRight:10},center:_objectSpread2({},center$3),page:{marginLeft:10,marginRight:10},root:{padding:20,minHeight:"calc(100vh - 65px - 40px)"}},UserDetail=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"fetch",(function(){var e,t,n,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=r.props.store,s.next=3,regenerator.awrap(Promise.all([e.user.fetch(r.props.match.params.id),e.role.fetchAll()]));case 3:t=s.sent,n=_slicedToArray(t,2),a=n[0],o=n[1],a.ok||e.notification.show("User error"),o.ok||e.notification.show("Role error");case 9:case"end":return s.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleRoleActive",(function(e){return function(t,n){n?r.props.store.user.assign(e.id):r.props.store.user.deassign(e.id)}})),r.fetch(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e,t=this,r=this.props.store,n=r.role,a=r.user;return e=0===n.list.data.length?null:n.list.data.map((function(e){var r=a.detail.roles.filter((function(t){return t.id===e.id})).length>0;return React.createElement(core.ListItem,{key:e.id,style:styles$9.item,dense:!0,button:!0},React.createElement(core.Avatar,{style:styles$9.avatar},e.id),React.createElement(core.ListItemText,{primary:e.name}),React.createElement(core.ListItemSecondaryAction,null,React.createElement(core.Switch,{onChange:t.handleRoleActive(e),checked:r})))})),React.createElement(Template$1,{secure:!0,style:{}},React.createElement(core.Paper,{style:styles$9.root},"email:  ",React.createElement("span",{"data-id":"email"},a.detail.email),React.createElement(core.List,null,e)))}}]),t}(),detail$3=withStore(UserDetail),initial$4={detail:{email:"",roles:[]},list:{data:[],pages:0,total:0}},UserList$2=function(e){function t(e){var r;return _classCallCheck(this,t),_defineProperty(_assertThisInitialized(r=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,e))),"fetch",(function(){var e,t,n,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return e=r.props.store,t=e.notification,n=e.user,s.next=3,regenerator.awrap(n.fetchAll(r.props.match.params.page));case 3:(a=s.sent).ok||(o=errors(a),t.show(o.message));case 5:case"end":return s.stop()}}))})),_defineProperty(_assertThisInitialized(r),"handleUserActive",(function(e){return function(){r.props.store.user.edit(e.id,{active:!e.active})}})),r.fetch(),r}return _inherits(t,React.Component),_createClass(t,[{key:"render",value:function(){var e=this,t=Number(this.props.match.params.page||"0"),r=0!==t?React.createElement(reactRouterDom.Link,{to:1!==t?"/users/".concat(t-1):"/users"},React.createElement(core.Button,{variant:"outlined"},"<")):React.createElement(core.Button,{variant:"outlined",disabled:!0},"<"),n=t<this.props.store.user.list.pages-1?React.createElement(reactRouterDom.Link,{to:"/users/".concat(t+1)},React.createElement(core.Button,{variant:"outlined"},">")):React.createElement(core.Button,{variant:"outlined",disabled:!0},">"),a=this.props.store.user.list.data.map((function(t){return React.createElement(core.List,{style:styles$9.item,key:t.id},React.createElement(core.ListItem,{dense:!0,button:!0},React.createElement(core.Avatar,{style:styles$9.avatar},t.id),React.createElement(core.ListItemText,{primary:t.email}),React.createElement(core.ListItemSecondaryAction,null,React.createElement(core.Switch,{onChange:e.handleUserActive(t),checked:t.active,disabled:t.id===e.props.store.me.detail.id}),React.createElement(reactRouterDom.Link,{to:"/user/".concat(t.id)},React.createElement(core.Button,{style:styles$9.details,variant:"outlined",color:"primary"},"Details")))))}));return React.createElement(Template$1,{secure:!0,style:{}},React.createElement(core.Paper,{style:styles$9.root},a,React.createElement("div",{style:styles$9.center},r,React.createElement(core.Avatar,{style:styles$9.page,"data-id":"page"},String(t)),n)))}}]),t}(),list$1=withStore(UserList$2),service$3={assign:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.post("/roles/".concat(t,"/user"),{id:e}));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},deassign:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.delete("/roles/".concat(t,"/user/").concat(e)));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},create:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.post("/users",e));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},edit:function(e,t){var r;return regenerator.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,regenerator.awrap(rest.patch("/users/".concat(e),t));case 2:return r=n.sent,n.abrupt("return",r.data);case 4:case"end":return n.stop()}}))},fetch:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.get("/users/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))},fetchAll:function(){var e,t,r,n=arguments;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return e=n.length>0&&void 0!==n[0]?n[0]:0,t=n.length>1&&void 0!==n[1]?n[1]:10,a.next=4,regenerator.awrap(rest.get("/users",{headers:{Page:e,PerPage:t}}));case 4:return r=a.sent,a.abrupt("return",r.data);case 6:case"end":return a.stop()}}))},remove:function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regenerator.awrap(rest.delete("/users/".concat(e)));case 2:return t=r.sent,r.abrupt("return",t.data);case 4:case"end":return r.stop()}}))}},UserStore=function e(t,r){var n=this;_classCallCheck(this,e),_defineProperty(this,"fetch",(function(e){var t,r,a;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,regenerator.awrap(service$3.fetch(e));case 3:return t=o.sent,r=_objectSpread2({},t,{ok:!0}),n.setDetail(r),o.abrupt("return",r);case 9:return o.prev=9,o.t0=o.catch(0),a={ok:!1},n.setDetail(_objectSpread2({},initial$4.detail,{},a)),o.abrupt("return",_objectSpread2({},o.t0,{},a));case 14:case"end":return o.stop()}}),null,null,[[0,9]])})),_defineProperty(this,"fetchAll",(function(){var e,t,r,a=arguments;return regenerator.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:0,t=a.length>1&&void 0!==a[1]?a[1]:10,o.prev=2,o.next=5,regenerator.awrap(service$3.fetchAll(e,t));case 5:return r=o.sent,n.setList(r),o.abrupt("return",_objectSpread2({},r,{ok:!0}));case 10:return o.prev=10,o.t0=o.catch(2),o.abrupt("return",_objectSpread2({},o.t0,{ok:!1}));case 13:case"end":return o.stop()}}),null,null,[[2,10]])})),_defineProperty(this,"create",(function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regenerator.awrap(service$3.create(e));case 3:return t=r.sent,r.abrupt("return",_objectSpread2({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",_objectSpread2({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),_defineProperty(this,"edit",(function(e,t){var r,a,o;return regenerator.async((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,regenerator.awrap(service$3.edit(e,t));case 3:return r=s.sent,a=_objectSpread2({},r,{ok:!0}),n.detail.id===e&&n.setDetail(a),(o=_objectSpread2({},n.list)).data.forEach((function(t){t.id===e&&(t.email=r.email,t.active=r.active,t.admin=r.admin)})),n.setList(o),s.abrupt("return",a);case 12:return s.prev=12,s.t0=s.catch(0),s.abrupt("return",_objectSpread2({},s.t0,{ok:!1}));case 15:case"end":return s.stop()}}),null,null,[[0,12]])})),_defineProperty(this,"delete",(function(e){var t;return regenerator.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,regenerator.awrap(service$3.delete(e));case 3:return t=r.sent,r.abrupt("return",_objectSpread2({},t,{ok:!0}));case 7:return r.prev=7,r.t0=r.catch(0),r.abrupt("return",_objectSpread2({},r.t0,{ok:!1}));case 10:case"end":return r.stop()}}),null,null,[[0,7]])})),_defineProperty(this,"assign",(function(e){var t,r;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regenerator.awrap(service$3.assign(n.detail.id,e));case 3:return t=a.sent,(r=_objectSpread2({},n.detail,{ok:!0})).roles.push(t),n.setDetail(r),a.abrupt("return",r);case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",_objectSpread2({},a.t0,{ok:!1}));case 13:case"end":return a.stop()}}),null,null,[[0,10]])})),_defineProperty(this,"deasign",(function(e){var t,r;return regenerator.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,regenerator.awrap(service$3.deassign(n.detail.id,e));case 3:return t=a.sent,(r=_objectSpread2({},n.detail,{ok:!0})).roles=n.detail.roles.filter((function(e){return e.id!==t.id})),n.setDetail(r),a.abrupt("return",r);case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",_objectSpread2({},a.t0,{ok:!1}));case 13:case"end":return a.stop()}}),null,null,[[0,10]])})),this.detail=t[0],this.setDetail=t[1],this.list=r[0],this.setList=r[1]},index$5={detail:detail$3,initial:initial$4,list:list$1,store:UserStore};exports.Auth=index,exports.Dashboard=index$1,exports.Me=index$2,exports.NoPage=index$3,exports.Role=index$4,exports.Store=Store,exports.User=index$5,exports.withStore=withStore;
//# sourceMappingURL=index.js.map
